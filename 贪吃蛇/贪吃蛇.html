<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<style type="text/css">
		#wrap{
			width:780px;
			height:780px;
			border:5px solid black;
			position:relative;
			margin:auto;
			background-image:url(bg.png);
		}
		#wrap div{
			position: absolute;
			height:15px;
			width:15px;
			background:blue;
		}
	</style>
</head>
<body>
<div id="wrap"></div>
</body>

<script type="text/javascript">
	var wrap=document.getElementById("wrap");
	// var shu=1;
	var num= 5;
	var user1=2;
	var user2=2;
	for(var i=0;i<num;i++){chan(i)}
	var vx1=1;	
	var vy1=0;
	var x1=1;
	var y1=0;
	var vx2=1;	
	var vy2=0;
	var x2=1;
	var y2=51;
	var wW=wrap.clientWidth;
	var wH=wrap.clientHeight;
	var ting=false;
	var timer=setInterval(function(){
		x1+=vx1;
		y1+=vy1;
		x2+=vx2;
		y2+=vy2;
		var wrap=document.getElementById("wrap");
		wrap.children[0].remove();
		var div=document.createElement("div");
		var divL=document.querySelectorAll("#wrap div");
		wrap.insertBefore(div,wrap.children[user1-1]);
		
		var wrap=document.getElementById("wrap");
		wrap.children[user1].remove();
		var div=document.createElement("div");
		var divL=document.querySelectorAll("#wrap div");
		var wrap=document.getElementById("wrap");

		wrap.insertBefore(div,wrap.children[divL.length-1]);
		var divL=document.querySelectorAll("#wrap div");
		

		for(var k=0;k<divL.length-2;k++){
			if((x1*15==divL[k].offsetLeft&&y1*15==divL[k].offsetTop)||x2*15==divL[k].offsetLeft&&y2*15==divL[k].offsetTop){
				ting=true;
			}
		}

		// for(var k=0;k<divL.length-2;k++){
		// 	if(x1*15==divL[k].offsetLeft&&y1*15==divL[k].offsetTop){
		// 		ting=true;
		// 	}
		// }
		
		if(x1<0||y1<0||x1*15>wW-15||y1*15>wH-15||ting||x2<0||y2<0||x2*15>wW-15||y2*15>wH-15){
			clearInterval(timer);
			alert("Game over!")
			return
		}
		divL[user1-1].style.background="red";
		divL[user1-1].style.left=x1*15+"px";
		divL[user1-1].style.top=y1*15+"px";
		divL[divL.length-2].style.left=x2*15+"px";
		divL[divL.length-2].style.top=y2*15+"px";
		if(fx==x1*15&&fy==y1*15){
			wrap.insertBefore(wrap.children[divL.length-1],wrap.children[user1-1]);
			// wrap.children[divL.length-1].remove();

			food();
			user1++;
		}
		if(fx==x2*15&&fy==y2*15){
			wrap.insertBefore(wrap.children[divL.length-1],wrap.children[divL.length-2]);
			food();
			user2++;
		}

	},300)
	function chan(i){
		
		if(i==4){
			food();}else{
			var div=document.createElement("div");
			if(i>1){
			div.style.top=51*15+"px";	
			}
		div.style.left=i*15+"px";
		wrap.appendChild(div);	
			}
		
	}
	// 食物生成及其的位置
	function food(){

		var divL=document.querySelectorAll("#wrap div");
		var div=document.createElement("div");
		fx=ranFn();
		fy=ranFn();
		for(var j=0;j<divL.length;j++){
			if(fx==divL[j].offsetLeft&&fy==divL[j].offsetLeft){
				fx=ranFn();
				fy=ranFn();
				j=0;
			}
		}
		div.style.background="url(f1.png)"
		div.style.left=fx+"px"
		div.style.top=fy+"px"
		wrap.appendChild(div);
	}
	function ranFn(){
		return Math.floor(Math.random()*52)*15
	}
	// 键盘事件 控制方向
	window.onkeydown=function(e){
		console.log(e.keyCode)
		if(e.keyCode==37){
			if(vx1==0){
			 vx1=-1;	
			 vy1=0;
			}	
		}else if(e.keyCode==38){
			if(vy1==0){
				vx1=0;
				vy1=-1;
			}
		}else if(e.keyCode==39){
			if(vx1==0){
			 vx1=1;	
			 vy1=0;
			}
		}else if(e.keyCode==40){
			if(vy1==0){
				vx1=0;
				vy1=1;
			}
		}

		if(e.keyCode==65){
			if(vx2==0){
			 vx2=-1;	
			 vy2=0;
			}	
		}else if(e.keyCode==87){
			if(vy2==0){
				vx2=0;
				vy2=-1;
			}
		}else if(e.keyCode==68){
			if(vx2==0){
			 vx2=1;	
			 vy2=0;
			}
		}else if(e.keyCode==83){
			if(vy2==0){
				vx2=0;
				vy2=1;
			}
		}
	}

		

</script>
</html>